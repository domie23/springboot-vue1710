(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0b964887"],{"0ff7":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"list_comment"},t._l(t.list,(function(i,s){return e("div",{key:s,staticClass:"item_comment_box"},[e("div",{staticClass:"comment"},[e("div",{staticClass:"left_block"},[e("img",{directives:[{name:"default-img",rawName:"v-default-img",value:"/img/default.png",expression:"'/img/default.png'"}],staticStyle:{width:"4rem",height:"4rem"},attrs:{src:t.$fullUrl(i[t.vm.avatar])}})]),e("div",{staticClass:"right_block"},[e("div",{staticClass:"top_comment"},[e("div",{staticClass:"nickname"},[t._v(t._s(i[t.vm.nickname]))]),e("div",{staticClass:"time_block"},[e("div",{staticClass:"time"},[t._v(" "+t._s(t._f("formatDate")(i[t.vm.create_time]))+" ")])])]),e("div",{staticClass:"content",domProps:{innerHTML:t._s(i[t.vm.content])}}),Object.keys(t.obj).length?e("div",{staticClass:"comment_reply"},[e("b-button",{attrs:{variant:"outline"},on:{click:function(e){return t.reply_to_sb(i)}}},[t._v("回复")])],1):t._e()])]),i.list_reply?e("div",{staticClass:"list_reply ml-5"},t._l(i.list_reply,(function(i,s){return e("div",{key:s,staticClass:"mb"},[e("div",{staticClass:"fl"},[e("span",{staticClass:"nickname"},[t._v(t._s(i[t.vm.nickname]))])]),e("div",{staticClass:"fr"},[e("span",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(i[t.vm.create_time])))])]),e("div",{staticClass:"ml-5",domProps:{innerHTML:t._s(i[t.vm.content])}})])})),0):t._e()])})),0)},a=[],r=i("c6e7"),o={mixins:[r["a"]],props:{list:{type:Array,default:function(){return[]}},obj:{type:Object,default:function(){return{}}},vm:{type:Object,default:function(){return{avatar:"avatar",nickname:"nickname",content:"content",create_time:"create_time"}}}},data(){return{text:""}},methods:{reply_to_sb(t){this.obj.reply_to_id=t.comment_id}},components:{}},n=o,l=(i("5ca9"),i("0b56")),_=Object(l["a"])(n,s,a,!1,null,"1e098a4e",null);e["a"]=_.exports},"35db":function(t,e,i){"use strict";i("7bc0")},"56c9":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return t.publish_flag?e("div",{staticClass:"form_editor"},[e("div",{staticClass:"editor"},[e("quill-editor",{staticClass:"form_editor_block",model:{value:t.form.content,callback:function(e){t.$set(t.form,"content","string"===typeof e?e.trim():e)},expression:"form.content"}})],1),e("div",{staticClass:"btn_publish"},[e("b-button",{attrs:{variant:"outline-primary",block:""},on:{click:function(e){return t.publish()}}},[t._v("发表")])],1)]):t._e()},a=[],r=i("6265"),o={mixins:[r["a"]],props:{form:{type:Object,default(){return{content:""}}},post_url:{type:String,default(){return""}},publish_flag:{type:Boolean,default(){return!0}}},data(){return{}},methods:{publish(){if(this.user.user_id){var t=this.form;if(t=Object.assign(t,{user_id:this.user.user_id,avatar:this.user.avatar,nickname:this.user.nickname}),t.content){var e=this.post_url;e||(e="~/api/comment/add?"),this.$post(e,t,t=>{t.result?(this.$emit("update_comment"),this.form.content=""):t.error&&this.$toast(t.error.message)})}else this.$toast("输入内容不能为空")}else this.$router.push("/account/login")}},components:{}},n=o,l=(i("594d"),i("0b56")),_=Object(l["a"])(n,s,a,!1,null,"0c92ffb8",null);e["a"]=_.exports},"594d":function(t,e,i){"use strict";i("b1fc")},"5ca9":function(t,e,i){"use strict";i("af73")},"7bc0":function(t,e,i){},"83b9":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"diy_details page_course_information",attrs:{id:"course_information_details"}},[e("div",{staticClass:"warp"},[e("div",{staticClass:"container"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[e("div",{staticClass:"card_course_information"},[e("div_course_information",{attrs:{obj:t.obj}})],1)])])])]),t.$check_action("/comment/list","get")?e("div",{staticClass:"warp"},[e("div",{staticClass:"container"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[t.list_comment.length?e("bar_title",{staticClass:"mt",attrs:{title:"评论区"}}):t._e(),t.list_comment.length?e("div",{staticClass:"comment_box"},[e("list_comment",{staticClass:"w-100",attrs:{list:t.list_comment,obj:t.form_comment}}),e("b-pagination-nav",{attrs:{"base-url":t.$route.path,"number-of-pages":t.count_pages,"link-gen":t.link_gen,"first-number":"","last-number":""},on:{change:t.change_page}})],1):t._e(),e("div",{staticClass:"form_editor form_edit_box"},[e("div",{staticClass:"details_form_editor_title"},[t._v("发表评论")]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.form_comment.reply_to_id,expression:"form_comment.reply_to_id"}],staticClass:"fl ml-3 answer_title"},[t._v(" 对 "),e("i",[t._v(t._s(t.respondent))]),t._v(" 回复: ")]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.form_comment.reply_to_id,expression:"form_comment.reply_to_id"}],staticClass:"fr mr-3"},[e("b-button",{attrs:{variant:"outline-primary reset_answer_personnel",size:"sm"},on:{click:function(e){t.form_comment.reply_to_id=0}}},[t._v("重置回复人 ")])],1),e("form_editor",{staticClass:"fn",attrs:{form:t.form_comment},on:{update_comment:t.update_comment}})],1)],1)])])]):t._e()])},a=[],r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"diy_details_box diy_div_course_information"},[e("div",{staticClass:"warp"},[e("div",{staticClass:"container"},[e("div",{staticClass:"details_title"},[t._v("详情")]),e("div",{staticClass:"row"},[e("div",{staticClass:"row_top_wrap"},[t.imgList.length?e("div",{staticClass:"row_1"},t._l(t.imgList,(function(i,s){return e("div",{key:i+s,staticClass:"diy_img"},[e("img",{attrs:{src:t.$fullUrl(t.obj[i.name])}})])})),0):t._e(),e("div",{staticClass:"row_2",class:{flex_row2:!t.imgList.length}},t._l(t.itemList,(function(i,s){return e("div",{directives:[{name:"show",rawName:"v-show",value:t.$check_field("get",i.name),expression:"$check_field('get',item.name)"}],key:i+s,class:{flex_row2_item:!t.imgList.length}},[e("div",{staticClass:"view"},[e("div",{staticClass:"diy_title"},[e("span",[t._v(t._s(i.title)+":")])]),"UID"==i.type?e("div",{staticClass:"diy_field diy_uid",class:{flex_row2_item_text:t.imgList.length}},[e("span",[t._v(" "+t._s(t.get_user_info(i.name,t.obj[i.name]))+" ")])]):"视频"==i.type?e("div",{staticClass:"diy_field diy_video",class:{flex_row2_item_text:t.imgList.length}},[t.obj[i.name]?e("router-link",{attrs:{to:"/media/video?filename="+t.$fullUrl(t.obj[i.name])}},[e("span",[t._v(" 查看视频 ")])]):t._e()],1):"音频"==i.type?e("div",{staticClass:"diy_field diy_music",class:{flex_row2_item_text:t.imgList.length}},[t.obj[i.name]?e("audio",{staticStyle:{"text-align":"left"},attrs:{src:t.$fullUrl(t.obj[i.name]),controls:""}}):t._e()]):"文件"==i.type?e("div",{staticClass:"diy_field diy_music",class:{flex_row2_item_text:t.imgList.length}},[e("a",{staticStyle:{color:"rgb(64, 158, 255)"},attrs:{href:t.$fullUrl(t.obj[i.name]),target:"_blank"}},[t._v("点击下载")])]):"日期"==i.type?e("div",{staticClass:"diy_field diy_date",class:{flex_row2_item_text:t.imgList.length}},[e("span",[t._v(" "+t._s(t.$toTime(t.obj[i.name],"yyyy-MM-dd"))+" ")])]):"时间"==i.type?e("div",{staticClass:"diy_field diy_time",class:{flex_row2_item_text:t.imgList.length}},[e("span",[t._v(" "+t._s(t.$toTime(t.obj[i.name],"hh:mm:ss"))+" ")])]):"日长"==i.type?e("div",{staticClass:"diy_field diy_datetime",class:{flex_row2_item_text:t.imgList.length}},[e("span",[t._v(" "+t._s(t.$toTime(t.obj[i.name],"yyyy-MM-dd hh:mm:ss"))+" ")])]):"电话"==i.type||"手机"==i.type?e("div",{staticClass:"diy_field diy_phone",class:{flex_row2_item_text:t.imgList.length}},[e("span",[t._v(" "+t._s(t.obj[i.name])+" ")])]):"数字"==i.type?e("div",{staticClass:"diy_field diy_number",class:{flex_row2_item_text:t.imgList.length}},[e("span",[t._v(" "+t._s(t.obj[i.name])+" ")])]):"网址"==i.type?e("div",{staticClass:"diy_field diy_url",class:{flex_row2_item_text:t.imgList.length}},[e("div",[e("a",{staticStyle:{color:"rgb(64, 158, 255)"},attrs:{href:t.obj[i.name],target:"_blank"}},[t._v(t._s(t.obj[i.name]))])])]):"多文本"==i.type?e("div",{staticClass:"diy_field diy_desc",class:{flex_row2_item_text:t.imgList.length}},[e("div",[t._v(" "+t._s(t.obj[i.name])+" ")])]):e("div",{staticClass:"diy_field diy_text",class:{flex_row2_item_text:t.imgList.length}},[e("span",[t._v(" "+t._s(t.obj[i.name])+" ")])])])])})),0)]),e("div",{staticClass:"details_btn_wrap"},[t.$check_action("/course_selection_information/edit","add")?e("button",{staticClass:"btn btn-primary details_btn",on:{click:function(e){return t.to_form("/course_selection_information/edit")}}},[t._v(" 选课 ")]):t._e()]),t._l(t.richList,(function(i,s){return e("div",{directives:[{name:"show",rawName:"v-show",value:t.$check_field("get",i.name),expression:"$check_field('get',item.name)"}],key:i+s,staticClass:"rich_text"},[e("div",{staticClass:"view"},[e("div",{staticClass:"diy_title"},[e("span",{domProps:{textContent:t._s(i.title)}})]),e("div",{staticClass:"diy_html",domProps:{innerHTML:t._s(t.obj[i.name])}})])])}))],2)])])])},o=[],n=i("6265"),l=i("c6e7"),_={mixins:[n["a"],l["a"]],components:{},props:{obj:{type:Object,default:function(){return{}}}},data(){return{praiseLen:this.obj["praise_len"],imgList:[{title:"封面图片",name:"cover_photo",type:"图片"}],itemList:[{title:"课程名称",name:"course_name",type:"文本"},{title:"课程类型",name:"course_type",type:"文本"},{title:"上课地点",name:"class_location",type:"文本"},{title:"上课时间",name:"class_time",type:"文本"},{title:"课程人数",name:"number_of_courses",type:"文本"},{title:"可选人数",name:"number_of_people_available",type:"数字"},{title:"授课教师",name:"lecturer",type:"UID"}],richList:[{title:"详情介绍",name:"details",type:"编辑"}],list_user_lecturer:[]}},methods:{async get_list_user_lecturer(){var t=await this.$get("~/api/user/get_list?user_group=老师用户");t.result&&t.result.list?this.list_user_lecturer=t.result.list:t.error&&console.error(t.error)},get_user_info(t,e){var i=null;"lecturer"==t&&(i=this.list_user_lecturer.getObj({user_id:e}));var s="";return i&&(s=i.nickname+"-"+i.username),s}},created(){this.get_list_user_lecturer(),setTimeout(()=>{},1e3)},watch:{obj:{deep:!0,handler(){this.praiseLen=this.obj["praise_len"]}}}},c=_,m=(i("35db"),i("0b56")),d=Object(m["a"])(c,r,o,!1,null,null,null),u=d.exports,f=i("0ff7"),p=i("a3ca"),v=i("56c9"),h={mixins:[l["a"]],components:{list_comment:f["a"],bar_title:p["a"],form_editor:v["a"],div_course_information:u},data(){return{url_get_obj:"~/api/course_information/get_obj?",field:"course_information_id",obj:{},query:{course_name:"",cover_photo:"",course_type:"",class_location:"",class_time:"",number_of_courses:"",number_of_people_available:0,lecturer:0,details:"",course_information_id:0},praise:0,state_praise:!1,list_comment:[],form_comment:{source_table:"course_information",source_field:"course_information_id",source_id:0,reply_to_id:0},count_pages:1}},methods:{add_hits(t){t["hits"]=t["hits"]+1;var e=t["hits"];this.$post("~/api/course_information/set?course_information_id="+t["course_information_id"],{hits:e},t=>{if(t.result){console.log("添加访问量状态：",t.result);var e={source_table:"course_information",source_field:"course_information_id",source_id:this.obj.course_information_id,user_id:this.$store.state.user.user_id};this.$post("~/api/hits/add?",e,t=>{console.log(t)})}else t.error&&console.error(t.error)})},get_obj_after(t){if(t&&t.result&&t.result.obj){console.log(t.result.obj);var e=t.result.obj;this.obj=e,this.add_hits(e),this.get_comment(e),this.form_comment.source_id=this.obj.course_information_id}},link_gen(t){return{query:this.query}},change_page(t){this.get_comment(this.obj,t),this.form_comment.reply_to_id=0},update_comment(){this.get_comment(this.obj)},get_comment(t,e=1,i=5){this.$get("~/api/comment/get_list?",{source_table:"course_information",source_field:"course_information_id",source_id:this.obj["course_information_id"],page:e,size:i,reply_to_id:"0",orderby:"create_time desc"},t=>{if(t.result){var e=t.result.list;e.map(t=>{t.list_reply=[]}),this.add_reply(e).then(t=>{this.list_comment=t}),this.count_pages=Math.ceil(t.result.count/i)||1}})},add_reply(t){return new Promise(e=>{for(let i=0;i<t.length;i++){const e=t[i];this.$get("~/api/comment/get_list?",{source_table:"course_information",source_field:"course_information_id",source_id:this.obj["course_information_id"],orderby:"create_time desc",reply_to_id:e.comment_id},t=>{t.result&&(e.list_reply=t.result.list)})}e(t)})}},computed:{respondent(){var t=this.form_comment.reply_to_id,e="";return this.list_comment.map(i=>{i.comment_id===t&&(e=i.nickname)}),e}},mounted(){}},b=h,y=(i("d9e9"),Object(m["a"])(b,s,a,!1,null,null,null));e["default"]=y.exports},af73:function(t,e,i){},b1fc:function(t,e,i){},bc6b:function(t,e,i){},d9e9:function(t,e,i){"use strict";i("bc6b")}}]);
//# sourceMappingURL=chunk-0b964887.c6e9cc5a.js.map